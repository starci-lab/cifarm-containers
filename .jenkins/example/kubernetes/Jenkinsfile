podTemplate(
    containers: [
        // Use the Bitnami kubectl container to avoid downloading kubectl manually
        containerTemplate(
            name: 'kubectl',
            image: 'bitnami/kubectl:1.20.5',
            command: ["echo"],
            ttyEnabled: true
        )
    ],
    serviceAccount: 'jenkins'
) {
    node(POD_LABEL) {
        stage('Run kubectl commands') {
            container('kubectl') {
                // Use kubectl directly from the Bitnami container
                sh 'kubectl get pods -n cicd' // List pods in the cicd namespace
            }
        }
    }
}